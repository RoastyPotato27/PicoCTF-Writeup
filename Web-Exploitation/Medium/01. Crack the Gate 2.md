**Title:** Crack The Gate 2

**Difficulty:** Medium

**Summary (TL;DR):**

Exploiting Client-Side rate limiter to Bruteforce.

**1. Scope & Setup**

**Target:** http://amiable-citadel.picoctf.net:PORT/

**Environment:** Local System / PicoCTF VM

**Tools used:** Burpsuite, Browser

**2. Recom**

We are met with a login screen, After putting in the E-mail and password from the List given. After the 1st attempt,
we are met with a rate limiter. According to the hint, it is related to ```X-Forwarded-For```.

**What is X-Forwarded-For?**
>**X-Forwarded-For (XFF)** is an HTTP header used to identify the original client IP address when a request passes through >proxies or load balancers. It helps servers know the real user IP instead of the proxy's IP.

**3. Exploit**

Open BurpSuite and open the browser. Input the URL and forward the request in ```Proxy``` Tab.
Now that we have the login screen, input the email and anything in password. Click Login.
Send the POST request to the Intruder tab (ctrl + I).

Change the request as shown in the image:

<img width="811" height="554" alt="image" src="https://github.com/user-attachments/assets/40e97c9d-2e36-4d50-b50f-89a0a7ed2368" />

Now On the right side, Payload Section. Set paylaod 1 to numbers (X-Forwarded-For one) 

<img width="558" height="438" alt="image" src="https://github.com/user-attachments/assets/a8b74dc7-c63a-4d25-ab45-0eafa06ea805" />

In Payload 2, set it to "Simple List" and load the passwords.txt file that we got from the challenge.

<img width="557" height="464" alt="image" src="https://github.com/user-attachments/assets/4c1757d6-0bb8-4132-ab18-0f2394f7719b" />

Click on "Start Attack"

<img width="1034" height="238" alt="image" src="https://github.com/user-attachments/assets/b202c040-e56a-4e4d-b86a-f9dbdf8da4b1" />

Look for the Payload that has a different length than the rest. That one is our password. Click on it to see our 
request and response. Move over to Response and take the flag!

<img width="454" height="310" alt="image" src="https://github.com/user-attachments/assets/caf4770d-f178-4040-8836-7406b2eadd1c" />

**3. Flag**

```picoCTF{xff_byp4ss_brut3_3b2dc94d}```

**NOTE:** At first, I went through all the passwords by changing them manually, somehow it didnt work on any password.
But following this method it worked!? Well, atleast I got to learn the intruder tab of Burp:D

**4. References/Credits**

https://devnull-0.medium.com/crack-the-gate-2-picomini-d6aae6cbca03
